<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Lootcontainer-Simulator</title>
  <!-- Firebase SDKs (Compat for simplicity) -->
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-functions-compat.js"></script>
  <!-- Project config (create firebase-config.js with your project keys) -->
  <script src="firebase-config.js"></script>
  <!-- Firebase helper for this app -->
  <script src="firebase.js"></script>
  <script>
    (function() {
      function inject(ver) {
        try {
          var v = ver ? ('?v=' + encodeURIComponent(ver)) : '';
          var link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = 'style.css' + v;
          document.head.appendChild(link);

          var s = document.createElement('script');
          s.src = 'script.js' + v;
          s.defer = true;
          document.head.appendChild(s);
        } catch (e) {
          // Fallback (sollte selten nÃ¶tig sein)
          var link2 = document.createElement('link');
          link2.rel = 'stylesheet';
          link2.href = 'style.css';
          document.head.appendChild(link2);
          var s2 = document.createElement('script');
          s2.src = 'script.js';
          s2.defer = true;
          document.head.appendChild(s2);
        }
      }
      try {
        fetch('version.json', { cache: 'no-store' })
          .then(function(r){ return r.ok ? r.json() : { version: null }; })
          .then(function(meta){ inject(meta && (meta.version || meta.appVersion)); })
          .catch(function(){ inject(null); });
      } catch (e) { inject(null); }
    })();
  </script>
</head>
<body>
  <!-- Firebase Status Pill (shows connection/auth state) -->
  <div id="fbStatus" class="status-pill off" aria-live="polite" title="Firebase Status">Offline</div>
  <h1>Lootingsimulat<span id="secretDevSwitch" class="secret-dev-switch" title=" ">o</span>r <span class="app-version-inline" aria-label="Version">v0.9</span></h1>
  
  <p id="balance">ğŸ’°: 0</p>

  <!-- Sound Control -->
  <div id="soundControl">
    <button id="soundBtn" class="sound-btn" title="Sound an/aus">ğŸ”Š</button>
    <div id="volumeSlider" class="volume-slider" style="display:none;">
      <input type="range" id="volumeRange" min="0" max="100" value="50">
      <span id="volumePercent">50%</span>
    </div>
  </div>

  <!-- NEU: Alles in einem Wrapper -->

  <div id="containerArea">
    <div id="playRow">
      <div id="containerWrapper">
        <div id="overlay"></div>
        <div id="lootContainer" class="container-grid"></div>
      </div>
    </div>
    <!-- Box-Auswahl unter dem Lootcontainer und Ã¼ber dem Open-Button -->
    <div id="boxSelectionWrapper">
      <div id="boxSelection">
  <button id="boxBtn1" data-box="Box#1">Schublade<br><small>(Free)</small></button>
  <button id="boxBtn2" data-box="Box#2">Sporttasche<br><small>(1K ğŸ’°)</small></button>
  <button id="boxBtn3" data-box="Box#3">Koffer<br><small>(10K ğŸ’°)</small></button>
  <button id="boxBtn4" data-box="Box#4">Holzkiste<br><small>(100K ğŸ’°)</small></button>
  <button id="boxBtn5" data-box="Box#5">MilitÃ¤rkoffer<br><small>(250K ğŸ’°)</small></button>
  <button id="boxBtn6" data-box="Box#6">Safe<br><small>(500K ğŸ’°)</small></button>
  <button id="boxBtn7" data-box="Box#7">Tresor<br><small>(1M ğŸ’°)</small></button>
      </div>
      <div id="iconButtons">
        <button id="achievementsBtn" title="Erfolge">ğŸ†</button>
        <button id="statsBtn" title="Statistiken">ğŸ“Š</button>
        <button id="collectionBtn" title="Sammlung">ğŸ“š</button>
        <button id="leaderboardBtn" title="Leaderboard (Prestige)">ğŸ…</button>
      </div>
        <div id="devToggleWrapper">
          <label class="toggle-dev">
            <input type="checkbox" id="toggleDev">
            DEV anzeigen
          </label>
        </div>
    </div>
    <div id="actionButtons">
      <button id="shopBtn">ğŸª™ Shop</button>
      <button id="openBtn">Ã–ffnen ğŸ”‘</button>
    </div>
  </div>

<!-- Level & XP Display -->
<div id="levelDisplay">
  <div id="levelInfo">
    <span id="levelLeft"><span id="playerLevel">Level 1</span></span>
    <span id="playerTitle">AnfÃ¤nger</span>
  </div>
  <div id="xpBarContainer">
    <div id="xpBar"></div>
    <span id="xpText">0 / 500 XP</span>
  </div>
  <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
    <button id="skillsBtn">âš¡ Skills (<span id="skillPointsDisplay">0</span>)</button>
    <button id="prestigeBtn" title="Meta-Boni & Reset" aria-label="Meta-Boni & Reset">
      <span class="prestige-star" title="Prestige-Stufe">
        <span class="star">â­</span>
        <span class="num">0</span>
      </span>
    </button>
  </div>
</div>

<!-- Skill Tree Modal -->
<div id="skillModal" style="display:none;" class="overlay">
  <div class="modal-content skill-modal">
    <button id="closeSkillBtn" class="close-btn">âŒ</button>
    <h2>âš¡ Skill-Tree</h2>
    <p class="skill-points">VerfÃ¼gbare Punkte: <span id="availablePoints">0</span></p>
    
    <div class="skill-tree">
      <div class="skill-branch">
        <h3>ğŸ’° Wohlstand</h3>
        <p class="skill-description">ErhÃ¶ht Item-Werte<br>+5% pro Punkt</p>
        <div class="skill-level">
          <span id="wohlstandLevel">0</span> / 20
        </div>
        <button id="upgradeWohlstand" class="upgrade-btn">Upgrade</button>
      </div>
      
      <div class="skill-branch">
  <h3>ğŸ€ GlÃ¼ck</h3>
  <p class="skill-description">ErhÃ¶ht Rarity-Chancen und die Anzahl der Items<br>Bessere Drop-Verteilung</p>
        <div class="skill-level">
          <span id="glueckLevel">0</span> / 20
        </div>
        <button id="upgradeGlueck" class="upgrade-btn">Upgrade</button>
      </div>
      
      <div class="skill-branch">
        <h3>âš¡ Tempo</h3>
        <p class="skill-description">Schnellere Untersuchung<br>-5% Zeit pro Punkt</p>
        <div class="skill-level">
          <span id="effizienzLevel">0</span> / 10
        </div>
        <button id="upgradeEffizienz" class="upgrade-btn">Upgrade</button>
      </div>
    </div>
  </div>
</div>

<!-- Shop Modal -->
<div id="shopModal" style="display:none;" class="overlay">
  <div class="modal-content skill-modal">
    <button id="closeShopBtn" class="close-btn">âŒ</button>
    <h2>ğŸª™ Shop</h2>
    <p class="skill-points">Guthaben: <span id="shopBalance">0</span> ğŸ’°</p>
    
    <div id="shopContent">
      <!-- Shop-Items werden hier dynamisch eingefÃ¼gt -->
    </div>
  </div>
</div>

<!-- Stats Overlay -->
<div id="statsOverlay" style="display:none;" class="overlay">
  <button id="closeStatsBtn">âŒ</button>
  <h2>ğŸ“Š Statistiken</h2>
  <div id="statsContent"></div>
</div>

<!-- Achievements Overlay -->
<div id="achievementsOverlay" style="display:none;" class="overlay">
  <button id="closeAchievementsBtn">âŒ</button>
  <h2>ğŸ† Erfolge</h2>
  <div id="achievementsContent"></div>
</div>

<div id="collectionOverlay" style="display:none;" class="overlay">
  <button id="closeCollectionBtn">âŒ</button>
  <div id="collectionGrid" class="grid"></div>
  <button id="resetBtn" class="reset-btn">ğŸ”„ Fortschritt zurÃ¼cksetzen</button>
</div>

<!-- Prestige Modal -->
<div id="prestigeModal" style="display:none;" class="overlay">
  <div class="modal-content skill-modal">
    <button id="closePrestigeBtn" class="close-btn">âŒ</button>
    <h2>âœ¨ Prestige</h2>
    <div id="prestigeInfo" style="text-align:left; line-height:1.6;">
      <!-- Inhalte werden per JS gesetzt -->
    </div>
    <div style="display:flex; gap:10px; justify-content:center; margin-top:16px;">
      <button id="confirmPrestigeBtn" class="upgrade-btn">Jetzt prestigen</button>
    </div>
  </div>
  
</div>

<!-- Leaderboard Modal -->
<div id="leaderboardModal" style="display:none;" class="overlay">
  <div class="modal-content skill-modal">
    <button id="closeLeaderboardBtn" class="close-btn">âŒ</button>
    <h2>ğŸ… Leaderboard (Prestige)</h2>
    <div id="leaderboardContent"></div>
  </div>
</div>

  
</body>
</html>
